//
//  WDBaseFileControl.m
//  TangTradePlatform
//
//  Created by ctcios2 on 2017/10/14.
//  Copyright © 2017年 com.tang.trade. All rights reserved.
//

#import "WDBaseFileControl.h"
#import "WDFileModel.h"

#define baseFileName @"local.bin"

@implementation WDBaseFileControl

+ (BOOL)haveLocal {
    NSFileManager *manager=[NSFileManager defaultManager];
    
    NSString *path = NSSearchPathForDirectoriesInDomains(NSCachesDirectory, NSUserDomainMask, YES).firstObject;
    
    NSString *localPath = [path stringByAppendingPathComponent:baseFileName];
    
    return [manager fileExistsAtPath:localPath];
}

+ (void)creatLocalWithPassword:(NSString *)password {
    NSString *path = NSSearchPathForDirectoriesInDomains(NSCachesDirectory, NSUserDomainMask, YES).firstObject;
    
    NSString *localPath = [path stringByAppendingPathComponent:baseFileName];
    
    char c = 1;
    
    NSMutableData *data = [NSMutableData dataWithBytes:&c length:sizeof(c)];
    
    [data writeToFile:localPath atomically:YES];
}

+ (void)deleteLocal {
    NSString *path = NSSearchPathForDirectoriesInDomains(NSCachesDirectory, NSUserDomainMask, YES).firstObject;
    
    NSString *localPath = [path stringByAppendingPathComponent:baseFileName];
    
    [[NSFileManager defaultManager] removeItemAtPath:localPath error:nil];
}

+ (BOOL)judgeWithPassword:(NSString *)password {
    return YES;
}

+ (WDFileModel *)loadFileModelWithData:(NSData *)data {
    return [WDFileModel new];
}

+ (NSArray *)getBakUpDataName {
    NSFileManager *manager=[NSFileManager defaultManager];
    
    NSString *path = [NSHomeDirectory() stringByAppendingPathComponent:@"Documents"];
    
    NSArray* tempArray = [manager contentsOfDirectoryAtPath:path error:nil];
    
    NSMutableArray *realArray = [NSMutableArray array];
    
    for (NSString* fileName in tempArray) {
        if ([fileName hasSuffix:@".bin"]) {
            [realArray addObject:fileName];
        }
    }
    
    return realArray;
}

+ (BOOL)addDataToLocalWithBakUpName:(NSString *)name {
    NSString *string = [[NSHomeDirectory() stringByAppendingPathComponent:@"Documents"] stringByAppendingPathComponent:name];
    
    NSString *realData = [NSString stringWithContentsOfFile:string encoding:4 error:nil];
    
    DLog(@"%@",realData);
    
    [[NSFileManager defaultManager] removeItemAtPath:string error:nil];
    
    return YES;
}

@end
